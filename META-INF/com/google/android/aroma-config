### LICENSE:
#
# Copyright (C) 2011 Ahmad Amarullah ( http://amarullz.com/ )
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#
### FILE INFO:
#
# AROMA Installer 2.51 - AROMA Installer Test Script Configuration
#       (c) 2011-2012 by Ahmad Amarullah
#           amarullz - xda-developers
#           http://www.amarullz.com/
#
#       Binary Version  : 2.56
#       Binary Codename : Edelweis
#
### INFO:
#
# * AROMA Resource Dir  = META-INF/com/google/android/aroma
#
# * AROMA Temporary Dir = /tmp/aroma/
#
# * About Icon          = @alert - show <AROMA Resource Dir>/icons/alert.png
#                         or if theme used it will find <themedir>/icon.alert.png
#                         you can still access it via "icons/alert"
#
# * dp                  = Device Pixelate. WVGA/QHD = 3, HVGA = 2.
#                         dp calculated with = round(min(width,height) / 160)
#
###

##
# Fix Colorspace Issue
#
# For device which have a problem with color ( not display the correct color )
# try to set "force_colorspace" with ini_set. It may caused by wrong framebuffer
# information that passed by kernel into framebuffer device.
#
# You can use one of following values:
#   "rgba", "abgr", "argb", "bgra"
#
# NOTE: It must be in top most script, or you will got the color flicker
#
# ini_set("force_colorspace","rgba");
#

##
# Forcing Device Pixelate Size
#  defaut: floor( min( width, height ) / 160 )
#
# Usefull for tablet device, if interface was too big, you can
# force dp size for smaller UI size.
#
#-------- Uncomment one of this to use custom dp size:
#
# ini_set("dp","1"); #-- LDPI ( 240x320 / QVGA )
# ini_set("dp","2"); #-- MDPI ( 340x480 / HVGA )
# ini_set("dp","3"); #-- HDPI ( 480x800 / WVGA )
# ini_set("dp","4");
# ini_set("dp","5");
#

#### NOTE >> THIS VERSION DOESN'T NEED ANY CALIBRATION DATA :)


##
# Custom Key Code - Usefull For Some Device which not used
#                   Standard key code for up/down/select/back/menu
#
# You can capture the keycode in
# recovery using "aroma-keycapture-flashable.zip" Available in
# AROMA Installer Thread.
#
# Press some key when it run, it will return key code,
# that key can override up/down/select/back/menu actions in
# AROMA Installer, you can even set your home key for up, or
# volume down for select item
#
#-------- Uncomment & Modify this Code:
#
# ini_set("customkeycode_up",     "115");
# ini_set("customkeycode_down",   "114");
# ini_set("customkeycode_select", "116");
# ini_set("customkeycode_menu",   "229");
# ini_set("customkeycode_back",   "158");
#

##
# Initializing Rom Information
#
ini_set("rom_name",             "Mangusta-B550");
ini_set("rom_version",          "2.0");
ini_set("rom_author",           "mangusta86");
ini_set("rom_device",           "Huawei U9508");
ini_set("rom_date",             "July, 7 2013");


##
# Show Simple Splash
#
splash(
  #-- Duration 2000ms / 2 seconds
    2000,
  
  #-- <AROMA Resource Dir>/sample.png
    "sample"
);

##
# Show Animated Splash
#
anisplash(
  #-- Number of Loop
    4,
  
  #-- Frame 1 [ Image, duration in millisecond ]. <AROMA Resource Dir>/splash/a[1..6].png
    "splash/a1", 500,
    "splash/a2", 30,
    "splash/a3", 30,
    "splash/a4", 30,
    "splash/a5", 30,
    "splash/a6", 30
);

##[DEPRECATED]
# Show Calibrating Tools Directly before show any UI
#
#--- Remove this calibtool if you already know the calibrate data
# calibtool("");

#
# Set Small Font to Support all fonts
#
fontresload( "0", "ttf/Roboto-Regular.ttf;ttf/DroidSansArabic.ttf;ttf/DroidSansFallback.ttf;", "12" ); #-- Use sets of font (Font Family)

###################################################################################################################
#
# 1- SHOW LANGUAGE SELECTION
#
selectbox(
  #-- Title
    "Select Language",
  
  #-- Sub Title
    "Please select installer language that you want to use in this installation:",
  
  #-- Icon: <AROMA Resource Dir>/icons/personalize.png or <ThemeDir>/icon.personalize.png
    "@default",
  
  #-- Will be saved in /tmp/aroma/theme.prop
    "lang.prop",
  
  #---------------------------------[ Selectbox Without Group ]----------------------------------#
  # TITLE            |  SUBTITLE                                                 | Initial Value #
  #------------------+-----------------------------------------------------------+---------------#

    "English",            "Welcome to Installer",                                        1,      #-- selected.0 = 1
    "Espanol",            "Bienvenido al Instalador",                                    0,      #-- selected.0 = 2
    "Russian",            "Добро пожаловать в установщик",                               0,      #-- selected.0 = 3
    "Italian",            "Benvenuti nell'Installer",                                    0,      #-- selected.0 = 4
    "German",             "Willkommen bei Installer",					 0       #-- selected.0 = 5
  #--------[ Initial Value = 0: Unselected, 1: Selected, 2: Group Item, 3: Not Visible ]---------#
);

##
# SET LANGUAGE & FONT FAMILY
#
if prop("lang.prop","selected.0")=="1" then
  loadlang("langs/en.lang");
  fontresload( "0", "ttf/Roboto-Regular.ttf", "12" ); #-- "0" = Small Font ( Look at Fonts & UNICODE Demo Below )
  fontresload( "1", "ttf/Roboto-Regular.ttf", "18" ); #-- "1" = Big Font
endif;

if prop("lang.prop","selected.0")=="2" then
  loadlang("langs/es.lang");
  fontresload( "0", "ttf/Roboto-Regular.ttf", "12" );
  fontresload( "1", "ttf/Roboto-Regular.ttf", "18" );
endif;

if prop("lang.prop","selected.0")=="3" then
  loadlang("langs/ru.lang");
  fontresload( "0", "ttf/Roboto-Regular.ttf", "12" );
  fontresload( "1", "ttf/Roboto-Regular.ttf", "18" );
endif;

if prop("lang.prop","selected.0")=="4" then
  loadlang("langs/it.lang");
  fontresload( "0", "ttf/Roboto-Regular.ttf", "12" );
  fontresload( "1", "ttf/Roboto-Regular.ttf", "18" );
endif;

if prop("lang.prop","selected.0")=="5" then
  loadlang("langs/de.lang");
  fontresload( "0", "ttf/Roboto-Regular.ttf", "12" );
  fontresload( "1", "ttf/Roboto-Regular.ttf", "18" );
endif;


###################################################################################################################
#
# STEP 2 - SHOW ROM INFORMATION
#
viewbox(
  #-- Title
    "<~welcome.title>",
  
  #-- Text
    "<~welcome.text1> <b>"+
	  #-- Get Config Value
	  ini_get("rom_name")+
	"</b> <~common.for> <b>"+ini_get("rom_device")+"</b>.\n\n"+
    
    "<~welcome.text2>\n\n"+
	  "  <~rom.developer> : <b><#080>"+ini_get("rom_author")+"</#></b>\n"+
	"  <~rom.name> : <b><#080>"+ini_get("rom_name")+"</#></b>\n"+
      "  <~welcome.version>\t: <b><#selectbg_g>"+ini_get("rom_version")+"</#></b>\n"+
      "  <~welcome.codename>\t: <b><#selectbg_g>XPE</#></b>\n"+
      "  <~welcome.updated>\t: <b><#selectbg_g>"+ini_get("rom_date")+"</#></b>\n\n\n"+

    "<~welcome.next>",
  
  #-- Icon
    "@welcome"
);


###################################################################################################################
#
# STEP 3 - LICENSE
#
agreebox(
  #-- Title
    "<~terms.title>",
  
  #-- Subtitle / Description
    "<~terms.desc>",
  
  #-- Icon
    "@license",
  
  #-- Text Content ( Read from <AROMA Resource Dir>/license.txt )
    resread("license.txt"),
  
  #-- Checkbox Text
    "<~terms.check>",
  
  #-- Unchecked Alert Message
    "<~terms.confirm>"
);


###################################################################################################################
#
# STEP 4 - CHANGELOG
#
textbox(
  #-- Title
    "<~changelog.title>",
  
  #-- Subtitle
    "<~changelog.desc>",
  
  #-- Icon
    "@update",
  
  #-- Arg 4
    resread("changelog.txt")
);

##
##-- Back To English :D - and Use Roboto-Regular.ttf
##
#alert("Back To English","OK, Multilanguage ends here, sorry. It will use english now...", "@info");
#loadlang("langs/en.lang");
#fontresload( "0", "ttf/Roboto-Regular.ttf", "12" );
#fontresload( "1", "ttf/Roboto-Regular.ttf", "18" );
##
##

###################################################################################################################
#
# STEP 5 - WIPE
#
checkbox(
  #-- Title
	"<~wipe.title>",
	  
  #-- Sub Title
	"<~wipe.desc>",
	  
  #-- Icon
	"@wipe",
	  
  # Will be saved in /tmp/aroma/mods.prop
	"wipe.prop",
	  
  #----------------------------------[ Selectbox With Groups ]-----------------------------------#
  # TITLE            |  SUBTITLE                                                 | Initial Value #
  #------------------+-----------------------------------------------------------+---------------#
    "Wipe",             "",                                                             2,  	 #-- Group 1. key = "selected.1"
    "DATA",         	"<~wipe.data>",                             			0,       #-- item.1.1
    "CUST",       	"<~wipe.cust>",                            			0,       #-- item.1.2
    "SD",       	"<~wipe.internalsd>",                          			0        #-- item.1.3

  #--------[ Initial Value = 0: Unselected, 1: Selected, 2: Group Item, 3: Not Visible ]---------#
);


###################################################################################################################
#
# STEP 6 - SHOW MENUBOX - INSTALLATION TYPE
#
menubox(
  #-- Title
    "<~inst.title>",
  
  #-- Sub Title
    "<~inst.desc>",
  
  #-- Icon
    "@install",
    
  #-- Will be saved in /tmp/aroma/type.prop
    "type.prop",
    
  #-------------------------+-----------------[ Menubox Items ]-------------------------+---------------#
  # TITLE                   |  SUBTITLE                                                 |   Item Icons  #
  #-------------------------+-----------------------------------------------------------+---------------#
	
    "<~inst.default.title>",   	"<~inst.default.desc>",     				"@install",    #-- selected = 1
    "<~inst.stock.title>",   	"<~inst.stock.desc>",          				"@huawei",     #-- selected = 2
    "<~inst.minimal.title>",   	"<~inst.minimal.desc>",         			"@apps",   	#-- selected = 3
    "<~inst.custom.title>",    	"<~inst.custom.desc>",					"@customize"   #-- selected = 4

);


###################################################################################################################
#
# STEP 7 - SELECT MAIN MODS
#
if (prop("type.prop","selected")=="1") then
  #-- IF "Default" Installation, don't show configuration, then write default mods.prop
  #-- NOTE: mods.prop should exists, or updater-script will error
  writetmpfile(
    #-- Prop file will write to /tmp/aroma/mods.prop
	  "mods.prop",
	
	#-- Default Values
	  "item.1.1=0\n"+  #-- Default Huawei Services = No 
 	  "item.1.2=0\n"+  #-- Default Huawei Blob = No 
 	  "item.2.1=1\n"+  #-- Default Google Apps = Yes 
	  "item.2.2=1\n"+  #-- Default SuperSu = Yes 
	  "item.3.1=1\n"+  #-- Default Tweaks = Yes 
	  "item.3.2=1\n"   #-- Default S4 Sounds = Yes 
  );

else

if (prop("type.prop","selected")=="2") then
  #-- IF "Stock" Installation, don't show configuration, then write default mods.prop
  #-- NOTE: mods.prop should exists, or updater-script will error
  writetmpfile(
    #-- Prop file will write to /tmp/aroma/mods.prop
	  "mods.prop",
	
	#-- Default Values
	  "item.1.1=1\n"+  #-- Default Huawei Services = Yes 
 	  "item.1.2=1\n"+  #-- Default Huawei Blob = Yes 
 	  "item.2.1=0\n"+  #-- Default Google Apps = No 
	  "item.2.2=0\n"+  #-- Default SuperSu = No 
	  "item.3.1=0\n"+  #-- Default Tweaks = No 
	  "item.3.2=0\n"   #-- Default S4 Sounds = No 
  );

else
if (prop("type.prop","selected")=="3") then
  #-- IF "Minimal" Installation, don't show configuration, then write default mods.prop
  #-- NOTE: mods.prop should exists, or updater-script will error
  writetmpfile(
    #-- Prop file will write to /tmp/aroma/mods.prop
	  "mods.prop",
	
	#-- Default Values
	  "item.1.1=0\n"+  #-- Default Huawei Services = No 
 	  "item.1.2=0\n"+  #-- Default Huawei Blob = No 
 	  "item.2.1=0\n"+  #-- Default Google Apps = No 
	  "item.2.2=0\n"+  #-- Default SuperSu = No 
	  "item.3.1=0\n"+  #-- Default Tweaks = No 
	  "item.3.2=0\n"   #-- Default S4 Sounds = No 
  );

else
checkbox(
  #-- Title
	"<~mod.title>",
	  
  #-- Sub Title
	"<~mod.desc>",
	  
  #-- Icon
	"@default",
	  
  # Will be saved in /tmp/aroma/mods.prop
	"mods.prop",
	  
  #----------------------------------[ Selectbox With Groups ]-----------------------------------#
  # TITLE            |  SUBTITLE                                                 | Initial Value #
  #------------------+-----------------------------------------------------------+---------------#
    "<~mod.huawei.title>",	"",                                                 	2,  	 #-- Group 1. key = "item.1"
    "<~mod.services.title>",	"<~mod.services.desc>",              	        	0,       #-- item.1.1
    "<~mod.blob.title>", 	"<~mod.blob.desc>",                  			0,       #-- item.1.2

    "<~mod.system.title>",      "",                                                     2,  	 #-- Group 2. key = "item.2"
    "<~mod.gapps.title>",       "<~mod.gapps.desc>",                             	0,       #-- item.2.1
    "<~mod.su.title>",       	"<~mod.su.desc>",                            		1,       #-- item.2.2

    "<~mod.other.title>",	"",                                                     2,  	 #-- Group 3. key = "item.3"
    "<~mod.tweak.title>",       "<~mod.tweak.desc>",             			0,       #-- item.3.1
    "<~mod.sound.title>",       "<~mod.sound.desc>",             			0        #-- item.3.1

  #--------[ Initial Value = 0: Unselected, 1: Selected, 2: Group Item, 3: Not Visible ]---------#
);

endif;
endif;
endif;

##
#
# Next Screen is Installation UI, So change the next button text to "Install Now"
#
ini_set("text_next", "<~install.now>");

###################################################################################################################
#
# STEP 9 - MAKE SURE USER KNOW THAT NEXT STEP WAS INSTALLATION PROCESS
#
viewbox(
  #-- Title
    "<~install.title>",

  #-- Text
    "<~install.desc>",

  #-- Icon
    "@install"
);

##
#
# Next Button in successfull installation should be back to "Next >"
#
ini_set("text_next", "<~install.next>");

###################################################################################################################
#
# STEP 10 - INSTALLATION PROCESS
#
setvar("retstatus",
  install(
	#-- Title
      "<~proc.title>",
	
	#-- Installation Process message
	  "<b>"+ini_get("rom_name")+"</b> <~proc.desc1>\n\n"+
      "<~proc.desc2> <b>"+ini_get("rom_name")+
	  "</b>. <~proc.desc3>",
	
	#-- Installation Icon
      "@install",
	
	#-- Installation Finish Message
      "<~proc.desc4><b>"+ini_get("rom_name")+
	  "</b>. <~proc.desc5>"
  )
);

##
#
# Next Button is "Finish"
#
ini_set("text_next", "<~final.finish>");

###################################################################################################################
#
# STEP 11 - FINISH MESSAGE, Add Checkbox to Reboot or No. Save in "reboot_it" variable
#
# You can use return value or "reboot_it" variable to retrive checkbox value
# Example:
# if (checkviewbox(....)=="1" then
#    ... checked ...
# endif;
#
checkviewbox(
  #-- Title
    "<~final.title>",
  
  #-- Text
    "<#selectbg_g><b><~final.desc1></b></#>\n\n"+
    "<b>"+ini_get("rom_name")+"</b> <~final.desc2>\n\n"+
    "<~final.desc3>"+getvar("retstatus")+"\n\n",
	
  #-- Icon
    "@welcome",

  #-- Checkbox Text
    "<~final.desc4>",

  #-- Initial Checkbox value ( 0=unchecked, 1=checked ) -  (Optional, default:0)
    "1",

  #-- Save checked value in variable "reboot_it" (Optional)
    "reboot_it"
);

###
#
# Check if reboot checkbox was checked
if
  getvar("reboot_it")=="1"
then
  #
  # reboot("onfinish");   - Reboot if anything finished
  # reboot("now");        - Reboot Directly
  # reboot("disable");    - If you set reboot("onfinish") before, use this command to revert it.
  #
  reboot("onfinish");
endif;

#---- FINISH
